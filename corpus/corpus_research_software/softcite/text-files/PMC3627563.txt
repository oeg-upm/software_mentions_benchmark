
The symmetric differences were evaluated using the 'treedist' program that is contained in the PHYLIP package (http://evolution.gs.washington.edu/phylip.html). The benchmark tree that was constructed using the same dataset from the work of Zhou et al. (23), in which they concatenated the alignments of the 2034 core genes of the Escherichia/Shigella 26 genomes and used the maximum likelihood method to infer the phylogenetic relationships.
The 16S rDNA tree was generated as follows. For each organism, we first retrieved its 16S rDNA sequence using the 'Browsers' on the Ribosomal Database Project (http://rdp .cme.msu.edu/index.jsp) website, and then created MSA of these 16S rDNAs and built a tree using the 'Tree Builder' tools (http://rdp.cme.msu.edu/treebuilderpub/index.jsp) (25).
When the co-phylog method was applied to a real NGS dataset, L(S)-tuple with a minimum base quality under the threshold F were filtered (see the algorithm section). A dilemma in choosing the F value was that too small of an F might allow too many L(S)-tuple with 'wrong' objects past the filtering and therefore enlarge the deviation of the co-distance computed, while too large of an F might filter too much genomic information. We therefore explored the proper value range of F using simulated NGS data with sequencing qualities, which were generated using the tool 'Maq simulation' in the MAQ package (http://maq.sourceforge.net/). MAQ NGS data (distinguished from the perfect NGS data, using genome B. abortus 2308) of different depths were generated and different F values were tested on these MAQ NGS data; the proper range of F values were determined according to the co-distance d co (G 0 , G) between the MAQ NGS data G 0 and the complete genome G and the proportion q of genomic information taken by co-phylog.
The co-phylog (S = C 9,9 O 1 , qualities control threshold F = 10) tree constructed using the NGS raw dataset of the 29 E. coli organisms is almost identical to the tree built using the corresponding assembled genomes Figure 6). Given the accuracy of the co-phylog method based on assembled genomes has been proved previously, this test illustrates that co-phylog could be used in the phylogenetic analysis of unassembled NGS data. And as these NGS raw data came from all three popular sequencing platforms (454, Illumina and SOLID) (Supplementary Table S1), co-phylog is robust to the choice of sequencing platforms. The co-phylog tree (using S = C 12,12 O 1 , according to Supplementary Equation (S2) and F = 10) constructed on the NGS dataset from the five large diploid organisms matched well with the known taxonomy (Supplementary Figure S3), illustrating that the tool co-phylog can handle large size analyses and the complication of diploidy.
The time and memory consumption of co-phylog program (coded in C) were tested on a platform equipped with Intel Xeon X5650 2.67 GHz cpu (only one cpu was used for this test) and SUSE Linux Enterprise Server 10 SP2 (Â86_64). For real NGS dataset from the E. coli 29, which have an average sequencing depth of 95Â, co-phylog took 160M memory and 19 min completing the whole computing, including 14 min converting all NGS data into corresponding context-object sets and 5 min computing all pairwise co-distances. For the five mammalian organisms, co-phylog took 60G memory and 20 h completing the whole computing, including 17 h converting all NGS data into corresponding context-object sets and 3 h computing all pairwise co-distances.
