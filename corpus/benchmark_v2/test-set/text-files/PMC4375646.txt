
All EEG data processing was performed using ScanEdit v4.4 (Compumedics NeuroScan). Gradient switching artifact was removed using average artifact subtraction, which uses the regularity of the gradient switching induced waveform to generate a moving average artifact that can be successfully removed from the baseline EEG (Allen et al., 2000). Cardioballistic artifact is commonly seen in routine scalp EEG recordings. It is greatly amplified when EEG is recorded in the MR environment because movement of electrically conductive material in a static field results in electromagnetic induction. In contrast, cardioballistic artifact is not seen in routine clinical intracranial EEG records, nor was it seen in our intracranial EEG recordings in the MR environment. Therefore, removal of this artifact was not necessary. The reason why this artifact is not seen in clinical intracranial EEG recordings or in our iEEG-fMRI recordings is that intracranial electrodes(depth or subdural electrodes) are less prone to movement with cardiac pulsations because they are fixed to the skull or dura. Additionally, the distance between the active and reference electrodes is smaller for iEEG than scalp EEG, which further reduces the amplitude of cardioballistic artifact.
fMRI data processing was carried out using FEAT [FMRI Expert Analysis Tool, Version 6.00, part of FSL (FMRIB3s Software Library,http://www.fmrib.ox.ac.uk/fsl)]. The following pre-processing was applied: motion correction using MCFLIRT [Motion Correction: FMRIB3s Linear Image Registration Tool (Jenkinson et al., 2002)], slice-timing correction using Fourier-space time-series phase-shifting; non-brain removal using the Brain Extraction Tool (Smith, 2002), spatial smoothing using a Gaussian kernel of FWHM 6.0 mm; high-pass temporal filtering (Gaussian-weighted least-squares straight line fitting, with sigma = 50.0 s). Registration of fMRI data to high-resolution structural and standard-space images was carried out using FLIRT [FMRIB3s Linear Image Registration Tool (Jenkinson et al., 2002; Jenkinson and Smith, 2001)]. Because patient movement was minimal (b3 mm) in most patients, motion parameters were not included as regressors since motion correction via MCFLIRT [Motion Correction: FMRIB3s Linear Image Registration Tool (Jenkinson et al., 2002)] sufficiently minimized any motion effects.
The binary timing of interictal discharges was convolved with multiple hemodynamic response functions (HRFs) with time-to-peak ranging from 0-13 s, similar to the methodology employed for scalp EEGfMRI analyses by other groups (Bagshaw et al., 2004; Kobayashi et al., 2006a; Kobayashi et al., 2006b). The generated model was imported into FEAT where a time-series statistical analysis was carried out using FILM (FMRIB3s Improved Linear Model) with local autocorrelation correction for each run (Woolrich et al., 2001). Higher-level analyses were performed using a fixed effects model, by forcing the random effects variance to zero in FLAME (FMRIB3s Local Analysis of Mixed Effects) (Beckmann et al., 2003; Woolrich et al., 2004; Woolrich, 2008), generating a statistical average of all runs. To account for the increased probability of Type 1 error through the use of multiple HRFs, data were corrected using AlphaSim of the AFNI analysis packagehttp://afni.nimh.nih.gov/pub/dist/doc/program_help/AlphaSim.html that performs both probability and cluster-based thresholding at a significance level of p b 0.05, as determined by Monte Carlo simulations (Ward, 2000). Locations of the strongest activation were identified as the cluster (as determined by AlphaSim) with maximum peak response (Z-score). The gamma function time-to-peak for each subject3s maximal response was used. Parametric maps were overlaid onto highresolution structural images that were registered to MNI standard space.
