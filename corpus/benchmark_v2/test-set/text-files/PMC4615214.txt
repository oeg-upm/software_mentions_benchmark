
binding. 8 Through modulating the stability of the LDI via mutations, they eliminated the possibility of maturation protein being mostly synthesised by the equilibrated cloverleaf conformation. 7,8 Secondly, they directly assessed the kinetic model via adjusting the co-transcriptional time delayed for the LDI formation, and concluded that this duration is positively correlated with the yield of maturation protein. 8 Moreover, computational simulation of the co-transcriptional folding trajectory using KINWALKER does predict both the transient kinetic trap and the cloverleaf structure. 51 Mutational analysis also provides evidence supporting the functional importance of this metastable hairpin -the kinetic trap for this kinetic model -for the translation of maturation protein. Mutants with the metastable hairpin disrupted produce no plaque whereas compensatory double mutation is able to rescue the fitness of the phage. 7 On the other hand, mutation stabilising the metastable structure via replacing the bulge by a base pair increases the translation of maturation. 7 Furthermore, bulk evolution of those mutants with no metastable hairpin eventually leads to the restoration of the metastable hairpin. 7 Taken together, they imply the necessity of the metastable hairpin for the synthesis of maturation protein and thus the infection fitness of the phage.
Self-cleavage-permissive structure is an upstream hairpin The permissive structure for the self-cleavage of the HDV ribozyme is mapped to the nt ¡54/-18 of the RNA transcript using the secondary-structure prediction program MFOLD. 12 This structure sequesters the inhibitory stretch of nt ¡24/-15 from Alt1 in a hairpin P(-1) located upstream of the cleavage site. 12,81,82 This extended RNA transcript is demonstrated experimentally to cleave cotranscriptionally.
Firstly, structural mapping via ribonuclease was used to probe the nt ¡54/-1 fragment instead of the whole precursor transcript due to the fast-cleaving nature of this structure, which reveals a local hairpin P(-1) pairing nt ¡54/¡40 with ¡18/-30. 12 This structure is consistent with the ss-count values calculated Figure 5. Arc-plot of Tryptophan operon leader made using the visualisation program R-CHIE [96]. The left legend specifies the percentage of canonical base-pairs in the paired alignment columns, i.e. those connected by an arc. The right legend specifies the evolutionary support (e.g., covariation, etc.) for each position in the alignment. The alignment and arcs at the top show the information for the terminator structure, whereas the bottom ones correspond to the anti-terminator structure for the same underlying alignment. The lines in each alignment correspond to the respective sequences with every box representing either a nucleotide or a gap in the respective sequence. Every arc represents a base-pair involving the respective two alignment columns. The arcs are colour-coded according to their percentage of canonical base pairs, whereas the evolutionary information supporting each base pair is encoded in the colouring of the underlying nucleotides in the base paired alignment columns, see the right legend for details. Two green blocks connected by an arc implies that this is a canonical base pair (i.e., GC, AU or GU) which corresponds to the most abundant type of base pair for this pair of alignment columns. Cyan means this is a canonical base pair but that it has an one-sided mutation with respect to the most abundant (green) base-pair. Blue refers to a canonical base-pair which differs on both sides from the most abundant (green) base-pair. Red means this is a non-canonical base pair. Unpaired nucleotides are shown in black and gaps in grey.
using MFOLD which represent the propensity for a nucleotide position to be single-stranded. 12 Secondly, evolutionary conservation is found in hairpin P(-1) and the linking region between P(-1) and P1 among 21 genomic HDV RNA isolates. 12 Minimal sequence variation is also observed in this linking region (nt ¡17/¡1) which is pyrimidine-rich and suspected to melt the annealing between the nascent transcript and the template, facilitating the subsequent ribozyme folding. 12 Half-life of the structures No direct data exists regarding the half-life, but the mechanism proposed for the HDV ribozyme resembles the one utilised by the group I intron. 12 Moreover, in the human HDVlike CPEB3 ribozyme, a similar regulatory mechanism involving the flanking sequence was discovered. 13 As a follow-up study, an equilibrium model is proposed comprising two intermediate and the native fold, which is confirmed by mutagenesis and kinetic characterization. 84 In this model, the 5 0 portion of P2 can base-pair with either the native 3 0 portion or nonnative ribozyme sequence made of nucleotides from P1, P3 and single-stranded regions. 84 Given that P2 has a driving role in the correct folding of the HDV ribozyme, the direction of the shifting of this equilibrium may explain the resultant ribozyme activity. 84
We summarize the key features of our alignments in Tables 1 and 2. A small multiple sequence alignment (MSA) from a previous project published by us 14 was used to build a primary covariance model (CM) using the INFERNAL program 92 to search the full alignments in RFAM 1 and the NCBI TAXONOMY BROWSER. 93 In our previous research, 14 these small MSA were compiled using evolutionarily related sequences for these four RNA families, respectively. These small MSAs are of a high-quality with positive covariation and few gaps, making them convenient starting points to build the corresponding primary CMs. For each of our four alignments, we aligned the sequences of the seed alignment in RFAM with the primary CM first and then curated this against all experimentally verified structures which were first mapped to a reference sequence. We then build a secondary CM incorporating sequences from the RFAM seed alignment which we used to align the hits returned by the searchwith the primary CM. These hits were clustered to reduce primary sequence redundancy, choosing a representative sequence for each cluster based on structural fit and covariation. Hits passing this selection strategy were retained only if they contained all alternative structures. We then calculated quality measures for the resulting hits to determine which ones to add to the existing small MSA. The resulting alignment was then curated recursively according to the aligning results returned byINFERNAL using the secondary CM for each of the alternative structures.
Primary covariation model: Initial Small Alignment A primary covariation model (cm) is constructed using a small good-quality alignment assembled previously by our group; 14 repeat the CM compilation (i.e., build and calibrate in INFERNAL-1.1RC2) for each of the alternative structures. If the structure contains pseudo-knots, it must be split into non-pseudo-knotted substructures in order to process it in INFER-NAL; if possible, compatible helices of such non-pseudo-knotted substructures and the remaining alternative structures are combined into one structure so as to simplify the subsequent curation (e.g., in HDV, a non-pseudo-knotted substructure of the active conformation is added to the alt2 structure). The aforementioned preassembled alignments of Trp operon leader, Levivirus, HDV and SAM riboswitch have 10, 7, 10 and 15 sequences, respectively.
Secondary covariation model: preassembled alignment + unique RFAM seed alignment sequences Firstly, the primary CM is used to align the sequences from the RFAM seed alignment (or only part of it, e.g., the alternative structures of HDV are only valid for the genomic sequences, so only genomic sequences are aligned here). This aligning procedure is repeated for the primary CM built from each of the alternative structures. Secondly, redundant sequences are removed from this expanded alignment (i.e., sequence from pre-assembled alignment + RFAM seed alignment), which is subsequently manually curated to optimise the covariation for all alternative structures. Curation is initiated on the alignment generated by the CM with the structure with the largest number of base pairs, and the other alternative structural features are mapped onto the same alignment. During curation, RALEE 94 is used to visually compare the resultant alignments generated by the covariation models pertaining to each alternative structure, and structural overlapping regions are identified and then manually curated (section 4.1 (iv) of Supplementary Material). Thirdly, a secondary CM is thus built and calibrated based on this expanded alignment.
Expanded Alignment: select sequences to add into the original small MSA Overlapped hits Firstly, the primary CM for each alternative structure is used to search the RFAM full alignment via INFERNAL (alternatively, for Levivirus, NCBI TAXONOMY BROWSER is used by downloading the branch of the tree of life in which this non-coding RNA resides; for SAM riboswitch, we start our curation from an alignment provided by Winkler et al. (2003) 11 and the SAMbound structure is also annotated by them). A sequence is retained only if the searches using the CM of each individual alternative structure all return this sequence as a hit, and if this sequence spans the full length of all the CM without truncated ends. A hit is defined as a candidate sequence that yields log-odds score greater than 0 in the search result. Secondly, the secondary CM is used to align the overlapped hits; repeat the aligning step for all secondary CM corresponding to each of the alternative structures. Since the alignment constructing the secondary CM is optimised for all alternative structures, aligning the hits using the secondary CM facilitates the following curation among all alternative structures.
Cluster the aligned overlapped hits In order to reduce the sequence redundancy and increase the diversity, the alignment sequences comprised of the overlapped hits are clustered based on primary sequence conservation viaUSEARCH; 95 different percentage identity cutoffs are tested to obtain around 50 to 100 clusters. For each alternative structure, a best-fit sequence is chosen for each cluster using home-made scripts scoring the covariation. Best-fit sequences overlapped among all of the structures are identified as common hits. These common hits are then ranked and filtered based on the fit of the sequence to a structure and the extent of insertions relative to the reference sequence, which gives rise to a MSA for each structure.
