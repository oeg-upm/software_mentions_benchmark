
Regarding the first type of methods employed to detect subcomplexes in AP data, there are many available clustering algorithms that could be applied to the networks resulting from the scoring step. Most have been proposed following the assumption that complexes can be reconstructed from highly densely connected regions in the network 13: RNSC and MCL are some important examples 14. A review of twelve of these algorithms 15 claim that the best prediction method is ''Infomap'', followed by ''Fast modularity'', and ''Potts model approach''. However, it has also been argued that densely connected regions do not reflect functional units; hence, alternative ways to look at the complex prediction problem have been proposed 13,16,17. In addition, complex prediction algorithms have also evolved from algorithms that generate non-intersecting or non-overlapping clusters to algorithms that take into account the fact that protein complexes share subunits with other complexes, i.e., overlapping community detection algorithms. Some of these methods are MCODE 18, CFinder 19, Link-communities 10,20, OCG 11 , Cluster-ONE 21 and RSRGM 17. Regarding the second type of methods that allow subcomplex detection, an early strategy to take into account the overlapping nature of complexes and apply it to complex identification from AP experiments was introduced by Gavin et al. 6, who, after applying the SA score to AP data, performed repeated hierarchical clustering using different parameters to generate overlapping complexes that they described as composed of common ''cores'' and ''attachments''. Two recent papers, 22 and 23 , present a review of current clustering methods applied to protein complex identification. A group of methods, including CORE 24, COACH 25 and CACHET 26, deserve a special mention for explicitly incorporating the above-mentioned ''coreattachment'' model (other methods include: Markov random fields 27 and CODEC 28). In this paper, we will explore the detection of biologically relevant subcomplexes from AP data through some of the above-mentioned techniques, and suggest a new strategy which might be able to improve them. We will evaluate the use of some recent methods that are able to detect ''nested communities'' or ''hierarchies'', in order to prove whether or not these nested communities can detect biologically meaningful subcomplexes, while we introduce a new method to identify subcomplexes from AP data. We start from the premise that most of the previous procedures remove the multi-edge nature of pull-down data in an interaction network (i.e., bait-prey co-occurrences), which is the network signature of a subcomplex. For example, some scoring methods reduce all co-appearances of a bait and a prey protein to one single weighted interaction, whereas some clustering methods explicitly remove any subcomplex candidates. An example of this is the Leu4-Leu9 interaction from Gavin's dataset 6 : This interaction does not end up in any complexes when using the PE score, whilst the SA scores produce three complexes and the Dice score produces 2 complexes containing Leu4, Leu9 and a few more subunits. A Leu4-Leu9 complex does not appear in the results with any scoring method and, in fact, Leu4 and Leu9 are the subunits of the alpha-isopropylmalate synthase. This demonstrates how a highly scored copurification, which happens to be a complex, may get filtered out by the clustering method. Here we introduce TRIBAL (TRIad-Based ALgorithm), a novel method to identify subcomplexes from AP data that preserves and exploits this co-occurrence information.
Complex and subcomplex predictions. Protein complex predictions using each combination of scoring and overlapping clustering methods were performed. First, we scored Gavin's raw data using four of the most popular scoring systems: The SA score 6, the Hart score 7 , the PE score 5 and the ''Dice'' score 4 (seeThe four PINs were clustered using two different overlap-detecting clustering methods: ''Link-communities'' 10,20 and ''OCG'' 11. A description of the results can be observed in the Supplementary file (Supplementary Table 1).
Subcomplex predictions using the above-mentioned overlapping clustering strategies were generated by extracting all predicted complexes which were contained (meet-min 5 1.0) by at least one other predicted complex. The result was a prediction of 102 subcomplexesSubcomplexes predictions using the CACHET method were generated by removing all complexes without attachments and then selecting the cores of the remaining complexes, as explained in Methods. The result was 309 subcomplex predictions.
Other studies use different methods to determine what a match is. For example, Wu et al. 26 use a ''geometric index'' (also called NAscore) smaller than 0.2. The results under this alternative method can be found in Table 2. In this case, results partially contradict the previous analysis, and now Link communities has the best performance, with the best F-measure belonging to a combination of Dicescore and Link communities clustering. We hypothesize that the reason of this difference might be the fact that the hypergeometric score is more sensitive to the size of the complexes and OCG is predicting complexes of a size larger than expected, as it can be observed in the Supplementary file (section 4). However, our main interest is not to evaluate the ability to identify complexes but the ability to identify subcomplexes. We begin by verifying that all datasets under study contain subcomplexes: The MIPS dataset (our reference set) includes 16 subcomplexes. Raw data includes 348 groups of proteins contained in others. None of the sets produced by hierarchical clustering display subcomplexes, as these are non-overlapping methods. The predicted sets (Dice-lcomm, PElcomm, SA-lcomm, Dice-OCG, Hart-OCG, PE-OCG, CACHET and TRIBAL) display between 7 and 309 subcomplexes.
In order to evaluate the subcomplex detection abilities of these methods, we performed two different analyses. Table 3 summarizes the precision and recall analysis for predicted subcomplexes when compared to the full MIPS dataset, using a hyper-geometric score as a criterion for a match. Table 4 does the same when using the geometric score. The results show that CACHET has the best F-measure in both cases. Despite the fact that TRIBAL has the best precision in both cases, CACHET has a far better recall which ultimately leads to a better F-measure.
For this reason, we use the meet-min index to verify that predicted subcomplexes are not only similar but contained by MIPS complexes. Figure 2 depicts the number and percentage of validated predicted subcomplexes for TRIBAL, CACHET and six other methods which combine different scoring and clustering systems, using the meetmin index as comparison criterion. The results show that TRIBAL outperforms all other methods for meet-min equal to 1.0. CACHET shows a good performance to low meet-min values, but it decreases strongly when meet-min increases.
We tested and compared the performance of different combinations of scoring methods (Dice, PE, Hart, SA) and overlapping clustering algorithms (Link-communities, OCG), with one method based on the core-attachment model (CACHET) and our own method (TRIBAL). All these three types of methods are based on different assumptions; for example, that subcomplexes can be extracted from high-degree (highly connected) regions of the network or, in our case, that co-purification information with different baits is not only useful as a data quality measure but can also include co-complex information in different biological contexts. These assumptions can be partially validated through the performances of the methods. The results show that CACHET gives the best results in terms of similarity (geometric or hypergeometric indexes) to the MIPS reference set (this is mainly due to its better recall), while TRIBAL offers the best precision in terms of similarity and the best performance in terms of containment metrics (meet-min index). From the group of overlapping clustering methods, Link-communities shows better results than OCG.
We have made a thorough analysis of the traditional complex prediction pipeline for AP-MS experiments. Besides problems due to coverage, false positives and inconsistencies regarding mutual pull-down (see Supplementary File), most traditional methods are not able to detect subcomplexes due to decisions made in the scoring and clustering steps. Based on this knowledge, we have identified the best strategies to detect subcomplexes, including the development of TRIBAL, a simple strategy that improves the precision of subcomplex prediction compared to previous methods. These strategies are the initial attempts to specifically address the subcomplex detection problem in co-purification data. This paper suggests that overlapping clustering methods fail to detect subcomplexes from AP data while the core-attachment model used by CACHET and similar software seems to be the best option to this date. However, it also suggests that alternatives such as the co-purification matrix introduced by TRIBAL deserve more attention, as they show potential thanks to a high precision, especially when we evaluate the meet-min index, i.e., subcomplexes absolutely contained by larger complexes. Finally, research in subcomplex identification demands the generation of curated gold standards for subcomplexes, which will be an important step to achieve a better validation of predictions.
All analyses in this paper were performed using R v.2.15.2 and some of its packages, including ''iRefR'' v.1.00 12 , ''igraph'' v.0.64, and ''org.Sc.sgd.db'' v.2.9.1. All code needed to reproduce the following analyses can be found as Supplementary code.
Clustering methods. Link-communities is a method that uses communities of edges and not of nodes. OCG hierarchically merges edges into modules, checking the value of a special modularity function Q. Both OCG and Link-communities were performed using the ''linkcomm'' R package 20.
CACHET. The 369 complexes generated by CACHET from Gavin's dataset, were retrieved from their web page 26. In order to generate subcomplexes, we selected all complexes containing both core and attachments (i.e., we removed all only-core complexes). Subcomplexes were defined as the cores of those core-attachment sets.
The comparison is done through three strategies: Firstly, through a hypergeometric test, as defined in eq. (5). In this test, the population is the total number of proteins, the population success is the size of the MIPS complex, the sample is the predicted complex (predicted either by any combination of the scores and clustering algorithms here employed, CACHET or TRIBAL) and the success sample is the size of the intersection between MIPS and the predicted complex. The overlap is considered significant when p-value , 0.05. Secondly, the geometric index, defined as follows:
The performance of each method was assessed by computing their precision, recall and F-measure, defined as follows:TRIBAL algorithm. Both TRIBAL and its evaluations were coded using R 2.15.2 and its packages ''iRefR'' and ''igraph'', and they are available as Supplementary code.
